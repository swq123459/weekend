{
    "version": "latest",
    "description": "A tool to open vscode with Terminal profile",
    "homepage": "https://github.com/swq123459/code-terminal.git",
    "license": "MIT",
    "url": "https://github.com/swq123459/code-terminal/releases/latest/download/code-terminal.zip",
    "skiphash": true,
    "extract_dir": "code-terminal",
    "bin": "code-terminal.exe",
    "architecture": {
        "64bit": {
            "url": [
                "https://github.com/swq123459/code-terminal/releases/latest/download/code-terminal.zip",
                "https://raw.githubusercontent.com/swq123459/weekend/refs/heads/main/assets/install-context.reg",
                "https://raw.githubusercontent.com/swq123459/weekend/refs/heads/main/assets/uninstall-context.reg"
            ]
        }
    },
    "pre_install": [
        "$dirpath = $dir.Replace('\\', '\\\\')",
        "$exepath = \"$dir\\code-terminal.exe\".Replace('\\', '\\\\')",
        "'install-context', 'uninstall-context' | ForEach-Object {",
        "    if (Test-Path \"$dir\\$_.reg\") {",
        "        $content = Get-Content \"$dir\\$_.reg\" -Raw",
        "        $content = $content.Replace('$code', $exepath)",
        "        $content | Set-Content -Path \"$dir\\$_.reg\" -NoNewline",
        "    }",
        "}"
    ],
    "post_install": [
        "if (Test-Path \"$dir\\install-context.reg\") {",
        "    Write-Host 'Automatically adding \"Open in code-terminal\" to context menu (user level)...' -ForegroundColor Green",
        "    reg import \"$dir\\install-context.reg\" > $null",
        "}"
    ],
    "uninstaller": {
        "script": [
            "if ($cmd -eq 'uninstall' -and (Test-Path \"$dir\\uninstall-context.reg\")) {",
            "    Write-Host 'Removing \"Open in code-terminal\" context menu...' -ForegroundColor Yellow",
            "    reg import \"$dir\\uninstall-context.reg\" > $null",
            "}"
        ]
    },
    "notes": [
        "Context menu has been automatically registered. If manual registration is needed, run:",
        "reg import \"$dir\\install-context.reg\"",
        "The menu will be automatically removed during uninstallation."
    ],
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": [
                    "https://github.com/swq123459/code-terminal/releases/download/$version/code-terminal.zip",
                    "https://raw.githubusercontent.com/swq123459/weekend/refs/heads/main/assets/install-context.reg",
                    "https://raw.githubusercontent.com/swq123459/weekend/refs/heads/main/assets/uninstall-context.reg"
                ]
            }
        }
    }
}